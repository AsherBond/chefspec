<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.7.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>ChefSpec</h1>

<p>ChefSpec is a gem that makes it easy to write <a href="http://rspec.info/">RSpec</a>  examples for
<a href="http://www.opscode.com/chef/">Opscode Chef</a> cookbooks. Get fast feedback on cookbook changes before you spin up a node to do integration testing against.</p>

<p>ChefSpec runs your cookbook but without converging the node that your examples are being executed on. This allows you
to write specs that make assertions about the created resources given the combination of your recipes and arbitrary node
attributes that you provide.</p>

<h1>Compatibility</h1>

<p><strong>This is alpha-quality at the moment</strong>. The API is likely to change substantially. ChefSpec is currently tested with Chef 0.9.12 and 0.10.2 on MRI 1.8.7 and 1.9.2. It may make your machine burst into flames or install OS X Lion.</p>

<h1>Quick Start</h1>

<p>Given an existing cookbook directory structure, create a new <code>spec</code> directory within it to hold your specs.</p>

<h2>Writing a cookbook example</h2>

<p>This is a recipe that installs the foo package, and the matching example that expresses that expectation.</p>

<h3>cookbooks/example/recipes/default.rb</h3>

<pre class="code"><span class='id package'>package</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id action'>action</span> <span class='symbol'>:install</span>
<span class='kw'>end</span>
</pre>

<h3>cookbooks/example/spec/default_spec.rb</h3>

<pre class="code"><span class='id require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>chefspec</span><span class='tstring_end'>&quot;</span></span>

<span class='id describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>example::default</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id before'>before</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='ivar'>@chef_run</span> <span class='op'>=</span> <span class='const'>ChefSpec</span><span class='op'>::</span><span class='const'>ChefRunner</span><span class='period'>.</span><span class='id new'>new</span>
    <span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id converge'>converge</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>example::default</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>should install foo</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id install_package'>install_package</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>

<h2>Setting node attributes</h2>

<p>ChefSpec lets you set node attributes (including <a href="http://wiki.opscode.com/display/chef/Ohai">OHAI</a> attributes) as
you'd expect:</p>

<pre class="code"><span class='id it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>should log the node platform</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='ivar'>@chef_run</span> <span class='op'>=</span> <span class='const'>ChefSpec</span><span class='op'>::</span><span class='const'>ChefRunner</span><span class='period'>.</span><span class='id new'>new</span>
  <span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id node'>node</span><span class='period'>.</span><span class='id foo'>foo</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bar</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id converge'>converge</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>example::default</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The value of node.foo is: bar</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</pre>

<p>You can also pass a block to set the node attributes:</p>

<pre class="code"><span class='id runner'>runner</span> <span class='op'>=</span> <span class='const'>ChefSpec</span><span class='op'>::</span><span class='const'>ChefRunner</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id node'>node</span><span class='op'>|</span>
  <span class='id node'>node</span><span class='lbracket'>[</span><span class='symbol'>:my_attribute</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>bar</span><span class='tstring_end'>'</span></span>
  <span class='id node'>node</span><span class='lbracket'>[</span><span class='symbol'>:my_other_attribute</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>bar2</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span>
</pre>

<h1>Matchers</h1>

<p>You can use RSpec <code>should</code> and <code>should_not</code> to define the expected outcome of applying your recipe using the following
matchers:</p>

<h2>Files and Directories</h2>

<p>Matchers for the Chef <a href="http://wiki.opscode.com/display/chef/Resources#Resources-File">File</a> and <a href="http://wiki.opscode.com/display/chef/Resources#Resources-Directory">Directory</a> resources.</p>

<h3>create_file</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id create_file'>create_file</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/var/log/bar.log</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>delete_file</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id delete_file'>delete_file</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/var/log/bar.log</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>create_directory</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id create_directory'>create_directory</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/var/lib/foo</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>delete_directory</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id delete_directory'>delete_directory</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/var/lib/foo</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>be_owned_by</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id file'>file</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/var/log/bar.log</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id should'>should</span> <span class='id be_owned_by'>be_owned_by</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>group</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id directory'>directory</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/var/lib/foo</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id should'>should</span> <span class='id be_owned_by'>be_owned_by</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>group</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
</pre>

<h2>Packages</h2>

<p>Matchers for the Chef <a href="http://wiki.opscode.com/display/chef/Resources#Resources-Package">Package</a> resource.</p>

<h3>install_package</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id install_package'>install_package</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
<span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id install_package_at_version'>install_package_at_version</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1.2.3</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>purge_package</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id purge_package'>purge_package</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>remove_package</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id remove_package'>remove_package</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>upgrade_package</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id upgrade_package'>upgrade_package</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h2>Execute</h2>

<p>Matcher for the Chef <a href="http://wiki.opscode.com/display/chef/Resources#Resources-Execute">Execute</a> resource.</p>

<h3>execute_command</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id execute_command'>execute_command</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>whoami</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h2>Logging</h2>

<p>Matcher for the Chef <a href="http://wiki.opscode.com/display/chef/Resources#Resources-Log">Log</a> resource.</p>

<h3>log</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>A log message from my recipe</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h2>Services</h2>

<p>Matchers for the Chef <a href="http://wiki.opscode.com/display/chef/Resources#Resources-Service">Service</a> resource.</p>

<h3>start_service</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id start_service'>start_service</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>food</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>set_service_to_start_on_boot</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id set_service_to_start_on_boot'>set_service_to_start_on_boot</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>food</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>stop_service</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id stop_service'>stop_service</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>food</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>restart_service</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id restart_service'>restart_service</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>food</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h3>reload_service</h3>

<pre class="code"><span class='ivar'>@chef_run</span><span class='period'>.</span><span class='id should'>should</span> <span class='id reload_service'>reload_service</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>food</span><span class='tstring_end'>&quot;</span></span>
</pre>

<h1>More Examples</h1>

<p>There are further examples of using ChefSpec in the <code>features</code> directory.</p>

<h1>Building</h1>

<pre class="code">$ bundle install
$ bundle exec rake
</pre>

<h1>Continuous Integration</h1>

<p><a href="http://travis-ci.org/acrmp/chefspec">Chefspec on Travis CI</a></p>

<p><img src="https://secure.travis-ci.org/acrmp/chefspec.png?branch=master" alt="Built on Travis" /></p>

<h1>License</h1>

<p>MIT - see the accompanying LICENSE file for details.</p>

<h1>Contributing</h1>

<p>Additional matchers and bugfixes are welcome! Please fork and submit a pull request on an individual branch per change.</p>
</div></div>
    
    <div id="footer">
  Generated on Mon Sep 19 22:59:58 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.2).
</div>

  </body>
</html>